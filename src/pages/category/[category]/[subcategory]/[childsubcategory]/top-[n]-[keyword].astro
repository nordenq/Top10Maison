---
import Layout from "../../../../../layouts/BaseLayout.astro";
import { buildDataIndex } from "../../../../../utils/data";
import { subcategoryToplistUrl } from "../../../../../utils/routes";

export function getStaticPaths() {
  const { toplists } = buildDataIndex();
  return toplists.map((list) => ({
    params: {
      category: list.category,
      subcategory: list.subcategory,
      childsubcategory: list.childsubcategory,
      n: String(list.count),
      keyword: list.keywordSlug
    }
  }));
}

const { category, subcategory, childsubcategory, n, keyword } = Astro.params;
const redirectUrl = subcategoryToplistUrl(category, subcategory, Number(n), keyword);
const description = `This guide now lives at ${redirectUrl}. You are being redirected.`;
---

<Layout
  title="Guide moved | Top10Maison"
  description={description}
  canonical={redirectUrl}
  metaRefresh={`0; url=${redirectUrl}`}
>
  <section class="section">
    <div class="mx-auto w-full max-w-3xl text-center">
      <h1 class="text-2xl font-semibold">This guide has moved</h1>
      <p class="mt-3 text-sm text-ink/70">
        We updated our URL structure. You will be redirected automatically.
      </p>
      <a class="btn mt-6" href={redirectUrl}>Continue to the guide</a>
      <p class="mt-3 text-xs text-ink/60">
        Old path: /category/{category}/{subcategory}/{childsubcategory}/top-{n}-{keyword}
      </p>
    </div>
  </section>
</Layout>
