---
import BaseLayout from "../layouts/BaseLayout.astro";
import CategoryNav from "../components/CategoryNav.astro";
import CategoryCard from "../components/CategoryCard.astro";
import { buildDataIndex } from "../utils/data";
import { subcategoryToplistUrl } from "../utils/routes";
import { buildCanonical, requireSite } from "../utils/seo";
import { buildBreadcrumbSchema } from "../utils/schema";

const { categories, toplists } = buildDataIndex();
const latestToplists = [...toplists].sort((a, b) => b.performanceScore - a.performanceScore).slice(0, 4);
const categoryMap = new Map(categories.map((category) => [category.slug, category]));

const site = requireSite(Astro.site);
const title = "Top10Maison — Trending Product Rankings for Every Room";
const description = "Compare the best home products, track what’s trending, and shop smarter with our expert-built top 10 lists for kitchens, appliances, and more.";
const canonical = buildCanonical(site, "/");
const schema = [buildBreadcrumbSchema(site, [{ name: "Home", path: "/" }])];
---

<BaseLayout
  title={title}
  description={description}
  canonical={canonical}
  schema={schema}
  ogImage="/og-image.jpg"
>
  <section class="section bg-white">
    <div class="page-container grid items-center gap-10 md:grid-cols-2">
      <div>
        <p class="text-xs font-semibold uppercase tracking-[0.3em] text-ink/70">Home essentials hub</p>
        <h1 class="mt-3 text-4xl font-semibold md:text-5xl">Shop smarter with curated top lists.</h1>
        <p class="mt-4 text-lg text-ink/70">
          Best picks for your home. Trending. Trusted. Wallet-friendly.
        </p>
        <p class="mt-3 text-sm text-ink/70">
          AI-assisted research, reviewed by humans for clarity and real-world fit.
        </p>
        <div class="mt-6 flex flex-wrap gap-3">
          <a class="btn" href="#top-categories">Browse categories</a>
          <a class="btn-ghost" href="#latest-toplists">Latest top lists</a>
        </div>
      </div>
      <div class="card p-6">
        <h2 class="text-xl font-semibold">What you will find here</h2>
        <ul class="mt-4 space-y-3 text-sm text-ink/70">
          <li>Best‑of lists for every room, distilled from trusted sources online.</li>
          <li>Trending picks and smart comparisons to speed up your decision.</li>
          <li>Concise buying guidance that keeps the focus on what matters.</li>
          <li>Regularly refreshed picks based on ratings, review volume, and value.</li>
        </ul>
      </div>
    </div>
  </section>

  <section id="top-categories" class="section bg-white">
    <div class="page-container">
      <div class="flex flex-wrap items-end justify-between gap-4">
        <div>
          <h2 class="text-2xl font-semibold">Top categories</h2>
          <p class="mt-2 text-sm text-ink/70">Start with a room, then drill down to the best lists.</p>
        </div>
        <a class="text-sm font-semibold text-accent" href="/#top-categories">View all</a>
      </div>
      <div class="mt-6 grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        {categories.map((category) => (
          <CategoryCard category={category} />
        ))}
      </div>
    </div>
  </section>

  <section id="latest-toplists" class="section">
    <div class="page-container">
      <div class="flex flex-wrap items-end justify-between gap-4">
        <div>
          <h2 class="text-2xl font-semibold">Latest top lists</h2>
          <p class="mt-2 text-sm text-ink/70">Freshly updated guides with ranked picks and quick advice.</p>
        </div>
      </div>
      <div class="mt-6 grid gap-6 md:grid-cols-2">
        {latestToplists.map((list, index) => {
          const category = categoryMap.get(list.category);
          const image = list.image ?? category?.image ?? "/logo.svg";
          const isLcp = index === 0;
          return (
            <a
              class="card grid gap-4 overflow-hidden md:grid-cols-[200px_1fr]"
              href={subcategoryToplistUrl(list.category, list.subcategory, list.count, list.keywordSlug)}
            >
              <img
                class="h-full w-full object-cover"
                src={image}
                alt={list.title}
                loading={isLcp ? "eager" : "lazy"}
                fetchpriority={isLcp ? "high" : undefined}
                decoding="async"
                width="400"
                height="300"
              />
              <div class="p-5">
                <p class="text-xs font-semibold uppercase tracking-[0.25em] text-ink/70">Top list</p>
                <h3 class="mt-2 text-lg font-semibold">{list.title}</h3>
                <p class="mt-2 text-sm text-ink/70">{list.metaDescription}</p>
              </div>
            </a>
          );
        })}
      </div>
    </div>
  </section>

  <section class="section bg-white">
    <div class="page-container">
      <h2 class="text-2xl font-semibold">What is Top10Maison?</h2>
      <p class="mt-3 text-sm text-ink/70">
        Top10Maison is a home-focused review site that ranks products using consistent criteria, transparent
        scoring, and real-world use cases. Our goal is to help you choose faster with shortlists that reflect
        everyday needs, not marketing hype.
      </p>
    </div>
  </section>
</BaseLayout>
