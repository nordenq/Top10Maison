---
import type { Product } from "../utils/data";
import AffiliateButton from "./AffiliateButton.astro";
import { productUrl } from "../utils/routes";

const { product, rank } = Astro.props as { product: Product; rank: number };
---

<article class="card grid gap-6 p-6 md:grid-cols-[220px_1fr]" id={product.slug}>
  <div class="relative">
    <span class="absolute left-3 top-3 rounded-full bg-accent px-3 py-1 text-xs font-semibold text-white">
      #{rank}
    </span>
    <a href={productUrl(product.slug)}>
      <img
        class="h-48 w-full rounded-xl object-cover"
        src={product.image}
        alt={product.name}
        loading="lazy"
        width="640"
        height="360"
      />
    </a>
  </div>
  <div class="flex flex-col gap-4">
    <div>
      <h3 class="text-xl font-semibold">
        <a class="card-link" href={productUrl(product.slug)}>{product.name}</a>
      </h3>
      <p class="mt-2 text-sm text-ink/70">{product.description}</p>
      <p class="mt-3 text-sm">
        <span class="font-semibold">Best for:</span> {product.bestFor}
      </p>
    </div>
    <div class="grid gap-4 md:grid-cols-2">
      <div>
        <h4 class="text-sm font-semibold">Pros</h4>
        <ul class="mt-2 list-disc space-y-1 pl-5 text-sm text-ink/70">
          {product.pros.map((item) => (
            <li>{item}</li>
          ))}
        </ul>
      </div>
      <div>
        <h4 class="text-sm font-semibold">Cons</h4>
        <ul class="mt-2 list-disc space-y-1 pl-5 text-sm text-ink/70">
          {product.cons.map((item) => (
            <li>{item}</li>
          ))}
        </ul>
      </div>
    </div>
    <div class="mt-auto flex flex-wrap items-center gap-3">
      <span class="rounded-full bg-accent-soft px-3 py-1 text-sm text-ink">{product.price}</span>
      <AffiliateButton url={product.affiliateUrl} label="Check price" productSlug={product.slug} />
      <a class="btn-ghost" href={productUrl(product.slug)}>Read review</a>
    </div>
  </div>
</article>
