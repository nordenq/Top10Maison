---
import type { Product } from "../utils/data";

const { products, criteria } = Astro.props as {
  products: Product[];
  criteria: string[];
};

function resolveValue(product: Product, label: string): string {
  switch (label) {
    case "Best for":
      return product.bestFor;
    case "Key win":
      return product.uniqueValue;
    case "Price range":
      return product.price;
    default:
      throw new Error(`Unsupported quick compare criteria: ${label}`);
  }
}
---

<section class="section">
  <div class="mx-auto w-full max-w-5xl">
    <h2 class="text-2xl font-semibold">Quick comparison</h2>
    <div class="mt-4 overflow-x-auto">
      <table class="min-w-[640px] w-full border-collapse text-sm">
        <thead>
          <tr class="text-left text-ink/70">
            <th class="border-b border-border pb-3 pr-4">Rank</th>
            <th class="border-b border-border pb-3 pr-4">Product</th>
            {criteria.map((label) => (
              <th class="border-b border-border pb-3 pr-4">{label}</th>
            ))}
          </tr>
        </thead>
        <tbody>
          {products.map((product, index) => (
            <tr class="border-b border-border last:border-none">
              <td class="py-3 pr-4 font-semibold text-ink/80">#{index + 1}</td>
              <td class="py-3 pr-4">{product.name}</td>
              {criteria.map((label) => (
                <td class="py-3 pr-4 text-ink/70">{resolveValue(product, label)}</td>
              ))}
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  </div>
</section>
