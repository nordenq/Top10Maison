---
import type { Product } from "../utils/data";
import { productUrl } from "../utils/routes";
import AffiliateButton from "./AffiliateButton.astro";

const { product, rank } = Astro.props as { product: Product; rank?: number };
---

<article class="product-card">
  <div class="product-meta">
    {rank ? <span class="rank">#{rank}</span> : null}
    <a href={productUrl(product.slug)}>
      <img src={product.image} alt={product.name} loading="lazy" width="640" height="360" />
    </a>
  </div>
  <div class="product-body">
    <h3>
      <a href={productUrl(product.slug)}>{product.name}</a>
    </h3>
    <p>{product.description}</p>
    <div class="product-actions">
      <span class="price">{product.price}</span>
      <AffiliateButton url={product.affiliateUrl} label="Check price" productSlug={product.slug} />
    </div>
  </div>
</article>
