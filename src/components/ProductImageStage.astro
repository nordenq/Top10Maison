---
import { Image } from "astro:assets";

const { src, alt, rank, tag, loading = "lazy", width = 800, height = 800, fetchpriority = "auto" } =
  Astro.props as {
    src: string;
    alt: string;
    rank?: number;
    tag?: string;
    loading?: "lazy" | "eager";
    width?: number;
    height?: number;
    fetchpriority?: "high" | "low" | "auto";
  };
---

<div class="product-image-frame">
  <div class="image-skeleton" aria-hidden="true"></div>
  <Image
    src={src}
    alt={alt}
    loading={loading}
    widths={[320, 480, 640, width]}
    sizes="(max-width: 768px) 100vw, 480px"
    aspectRatio={width / height}
    decoding="async"
    fetchpriority={fetchpriority}
    width={width}
    height={height}
  />

  {tag ? (
    <span class="absolute bottom-3 left-3 z-10 rounded-full bg-emerald-900 px-4 py-1.5 text-sm font-semibold text-white shadow-sm">
      {tag}
    </span>
  ) : null}
  {typeof rank === "number" ? (
    <span class="absolute bottom-3 right-3 z-10 flex h-10 w-10 items-center justify-center rounded-full bg-slate-900 text-base font-bold text-white shadow-sm">
      #{rank}
    </span>
  ) : null}
</div>
